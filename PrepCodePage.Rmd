


```{r}
ggplot(topten_popularity, mapping = aes(y = popularity, x = pop_rank_integer, fill = track_artists)) +
  geom_col() +
  geom_label(label= topten_popularity$track_name ) +
  labs(title = "Top Tracks by Spotify's Popularity Index" , y ='Popularity' , x = 'Performer' ) +
  guides(guide_legend(title.theme = element_blank, reverse = TRUE, title = 'Artist'))
```


```{r}
topten_popularity %>%
      arrange(popularity) %>% 
      slice_max(3) %>% 
      #head(input$SlideOneToFive) %>% 
      ggplot(mapping = aes(y = popularity, 
                         x = pop_rank_integer, 
                         fill = track_artists)) +
      geom_col() +
      geom_label(label= topten_popularity$track_name ) +
      labs(title = "Top Tracks by Spotify's Popularity Index" ,
           y ='Popularity' ,
           x = 'Performer' ) #+
      # guides(guide_legend(reverse = TRUE,
      #                     title = 'Artist'))
```









#######################################################
######################################################
```{r}
    topten_popularity %>%
      head(input$popularity)
      ggplot(mapping = aes(y = popularity, 
                           x = pop_rank_integer, 
                           fill = track_artists)) +
      geom_col() +
      geom_label(label= topten_popularity$track_name ) +
      labs(title = "Top Tracks by Spotify's Popularity Index" , 
           y ='Popularity' , 
           x = 'Performer' ) +
      guides(guide_legend(title.them = element_blank, 
                                 reverse = TRUE,
                                 title = 'Artist'))
```

```{r}
##would still like to: 
##change colors to gold, silver, bronze...change key box next to artist NOT SAY a
##change labels to: 
##title = 'Top Tracks by Spotify's Popularity Index' 
##x = 'Top tracks by Spotify Popularity Index', 
##y = 'Spotify Popularity Index'
ggplot(topten_popularity, mapping = aes(y = popularity, x = pop_rank_integer, fill = track_artists)) +
  geom_col() +
  geom_label(label= topten_popularity$track_name ) +
  labs(title = "Top Tracks by Spotify's Popularity Index" , y ='Popularity' , x = 'Performer' ) +
  guides(guide_legend(label = TRUE, reverse = TRUE, title = 'Artist'))
```
%>% 
  mutate(pop_rank_integer = as.numeric(ordered(pop_rank_decimal))) %>% 
  filter(pop_rank_integer <=10)
```{r}

popularity_playlist = famer %>%    
  group_by(playlist_name) %>% 
  summarize(playlist_average = mean(popularity)) %>% 
  arrange(desc(playlist_average)) 

```
```{r}
# #2nd tab - popularity histogram of popularity scores by playlist
mean1 = mean(popularity_playlist$playlist_average)
popularity_playlist %>% 
  ggplot() +
  geom_histogram(mapping = aes(x = playlist_average,fill=..x..), bins = 14, boundary = 0, show.legend = FALSE) +
  scale_fill_gradient(low="yellow", high="orange") +
  labs(title = 'Average Spotify Popularity Score by Playlist', x = "Playlist's Spotify Popularity", 
       y = 'Number of playlists in this range') +
  geom_vline(xintercept = mean1)


```


df_po 
  ggplot(mapping = aes(x = playlist_name, y = playlist_average )) + 
  geom_box()
